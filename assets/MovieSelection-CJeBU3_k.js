import{j as e,a as p,F as u,r as i,u as I,L as C}from"./index-C41vkJjk.js";import{a as f}from"./axios-DsPaXkF5.js";import{f as M,a as G}from"./index-DYoqHdY8.js";const _=({movie:r})=>{const{id:n,original_title:o,poster_path:c}=r,s=c?`https://image.tmdb.org/t/p/w500/${c}`:Backup;return e.jsxs("div",{className:"max-w-sm bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 m-3 transform hover:scale-105 transition-transform duration-300 cursor-pointer",children:[e.jsx(p,{to:`/movie/${n}`,state:{movie:r},children:e.jsx("img",{className:"rounded-t-lg object-cover h-96 w-full",src:s,alt:o})}),e.jsx("div",{className:"p-5 text-center",children:e.jsx(p,{to:`/movie/${n}`,state:{movie:r},children:e.jsx("h5",{className:"mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:o})})})]})};function E({movies:r,onMovieSelect:n}){return e.jsx("div",{className:"movie-grid grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:r.map(o=>e.jsx(_,{movie:o,onMovieSelect:n},o.id))})}function L({currentPage:r,totalPages:n,onPageChange:o}){return e.jsxs("div",{className:"pagination-controls flex justify-center mt-4",children:[e.jsxs("button",{className:"mx-2 p-2 bg-white text-pink-500 rounded hover:bg-gray-100 transition ease-in-out duration-150",onClick:()=>o("prev"),disabled:r===1,children:[e.jsx(u,{icon:M})," Previous"]}),e.jsxs("span",{className:"mx-2 p-2 bg-white text-pink-500 rounded",children:["Page ",r," of ",n]}),e.jsxs("button",{className:"mx-2 p-2 bg-white text-pink-500 rounded hover:bg-gray-100 transition ease-in-out duration-150",onClick:()=>o("next"),disabled:r===n,children:["Next ",e.jsx(u,{icon:G})]})]})}function F(){const[r,n]=i.useState([]),[o,c]=i.useState(!0),[s,g]=i.useState(()=>parseInt(localStorage.getItem("currentPage"))||1),[m,b]=i.useState(1),[v,j]=i.useState([]),l=JSON.parse(localStorage.getItem("selectedGenres")),d=i.useRef(new Set),w=I();i.useEffect(()=>{(async()=>{try{const a=await f.get("https://api.themoviedb.org/3/genre/movie/list",{params:{api_key:"840037dbd0439b1f8c8bdc5ab0cf3f11"}});j(a.data.genres)}catch(a){console.error("Error fetching genres:",a)}})()},[]);const h=i.useCallback(async t=>{try{c(!0);const a=await f.get("https://api.themoviedb.org/3/discover/movie",{params:{api_key:"840037dbd0439b1f8c8bdc5ab0cf3f11",with_genres:l.join(","),sort_by:"popularity.desc",page:t}});n(a.data.results),b(a.data.total_pages),d.current.add(t),c(!1)}catch(a){console.error("Error fetching movies:",a),c(!1)}},[l]);i.useEffect(()=>{const t=parseInt(localStorage.getItem("scrollPosition"))||0;return l&&!d.current.has(s)&&h(s).then(()=>{window.scrollTo(0,t)}),()=>{localStorage.removeItem("scrollPosition")}},[l,s,h]);const S=t=>{localStorage.setItem("selectedMovie",JSON.stringify(t)),localStorage.setItem("scrollPosition",window.scrollY),w(`/movie/${t.id}`,{state:{movie:t}})},N=t=>{t==="next"&&s<m?g(s+1):t==="prev"&&s>1&&g(s-1),localStorage.setItem("currentPage",s+(t==="next"?1:-1)),k()},k=()=>{window.scrollTo({top:0,behavior:"smooth"})},y=t=>t.map(a=>{var x;return((x=v.find(P=>P.id===a))==null?void 0:x.name)||""}).join(", ");return o&&!d.current.has(s)?e.jsx(C,{}):e.jsxs("div",{className:"movie-selection-container p-4 bg-pink-500 text-white min-h-screen",children:[e.jsx("h2",{className:"text-center text-2xl font-bold mb-4",children:"Welcome to the Movie Selection!"}),e.jsx("p",{className:"text-center text-lg mb-4",children:"Remember, 27 is a special number. Let's pick the perfect movie!"}),e.jsxs("div",{className:"selected-categories mb-4 text-center",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Selected Categories:"}),e.jsx("p",{children:l.map(t=>e.jsx("span",{className:"inline-block bg-white text-pink-500 px-2 py-1 rounded-full m-1",children:y([t])},t))})]}),e.jsx(E,{movies:r,onMovieSelect:S}),e.jsx(L,{currentPage:s,totalPages:m,onPageChange:N})]})}export{F as default};
